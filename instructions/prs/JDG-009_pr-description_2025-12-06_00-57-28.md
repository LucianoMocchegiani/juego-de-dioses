# feat(database): Crear Terreno de Prueba para Primer Humano

## Resumen

Implementa un script de seed para crear un terreno de prueba simple y controlado de 40x40 metros diseñado para facilitar la creación del primer humano del juego. El terreno incluye: terreno plano con 10 capas de tierra, superficie de hierba, un lago de agua con forma orgánica y profundidad variable, una montaña pequeña con base circular, y exactamente 10 árboles distribuidos estratégicamente.

## Motivación

Se necesita un terreno de prueba simple y controlado para facilitar la creación del primer humano del juego. El demo existente (`seed_demo.py`) es demasiado complejo (acuífero subterráneo, muchos árboles) para pruebas iniciales. Se requiere un terreno más simple con recursos básicos (agua, madera, tierra) y elementos visuales claros (lago, montaña) para testing.

## Criterios de Aceptación

- [x] Terreno de prueba creado con dimensión 40x40 metros
- [x] Terreno plano con una montaña pequeña
- [x] Capa base de piedra en z=-11 cubriendo todo el área
- [x] Capas de tierra en z=-10 a z=-1 (10 capas) cubriendo todo el área
- [x] Superficie de hierba en z=0 cubriendo todo el área (excepto donde está el lago y la montaña)
- [x] Un lago de agua con forma orgánica creado bajo la superficie (z=0 a z=-9, 10 niveles de profundidad)
- [x] Una montaña pequeña con base circular creada con tierra y piedra
- [x] Exactamente 10 árboles creados y distribuidos en el terreno
- [x] Árboles no se superponen con el lago ni con la montaña
- [x] Terreno se puede cargar desde el frontend correctamente
- [x] Script de seed es ejecutable y crea el terreno de forma reproducible
- [x] Documentación del terreno creada

## Cambios Técnicos

### Backend

**Nuevo script de seed:**
- `backend/src/database/seed_human_test.py`: Script completo para crear terreno de prueba
  - Crea dimensión 40x40m con celda de 0.25m (160x160 celdas)
  - Capa base de piedra (z=-11)
  - 10 capas de tierra (z=-10 a z=-1)
  - Superficie de hierba (z=0)
  - Lago de agua con forma orgánica (radio 10m, profundidad variable 3-10 niveles)
  - Montaña pequeña con base circular (radio 6m, altura máxima 6 niveles)
  - 10 árboles distribuidos evitando lago y montaña

**Características del lago:**
- Forma orgánica circular/ovalada con variación aleatoria en bordes
- Profundidad variable: más profundo en el centro (10 niveles), menos en bordes (mínimo 3)
- Posición: centro-izquierda del terreno
- Agua bajo la superficie (z=0 a z=-9)

**Características de la montaña:**
- Base circular (no cuadrada) con variación en bordes
- Altura variable basada en distancia desde el centro
- Distribución de materiales: más tierra en base, más piedra en cima
- Posición: esquina superior derecha, separada del lago

**Documentación:**
- `backend/src/database/README.md`: Actualizado con información del nuevo script
- `instructions/examples/terrenos/terreno-prueba-humano.md`: Documentación completa del terreno

### Frontend

**Configuración:**
- `frontend/src/constants.js`: Cambiado `DEMO_DIMENSION_NAME` para cargar el nuevo terreno de prueba

## Testing

- [x] Probado localmente con Docker Compose
- [x] Script ejecutado exitosamente y crea terreno correctamente
- [x] Verificado en PostgreSQL que se crea la dimensión
- [x] Verificado que se crean todas las partículas (312,675 partículas totales)
- [x] Verificado que hay exactamente 10 árboles
- [x] Verificado que el lago tiene forma orgánica y profundidad variable
- [x] Verificado que la montaña tiene base circular
- [x] Verificado que árboles no se superponen con lago ni montaña
- [x] Frontend probado en navegador (carga el terreno correctamente)

## Screenshots/Demo

El terreno de prueba se carga correctamente en el frontend y muestra:
- Terreno plano de 40x40 metros con hierba
- Lago de agua con forma orgánica en centro-izquierda
- Montaña pequeña con base circular en esquina superior derecha
- 10 árboles distribuidos por el terreno

## Referencias

- Ticket: JDG-009
- Plan de acción: `instructions/tasks/JDG-009-action-plan_2025-12-05_23-56-24.md`
- Documentación del terreno: `instructions/examples/terrenos/terreno-prueba-humano.md`

## Deployment

### Cambios Requeridos

- [ ] Rebuild Docker images (no necesario, solo script Python)
- [ ] Ejecutar migraciones de base de datos (no aplica)
- [ ] Actualizar variables de entorno (no aplica)
- [x] Ejecutar script de seed cuando sea necesario: `docker-compose exec backend python -m src.database.seed_human_test`

### Verificación Post-Deployment

- [x] Verificar que el script se ejecuta correctamente
- [x] Verificar creación de dimensión en PostgreSQL
- [x] Verificar que se crearon todas las partículas
- [x] Verificar renderizado en frontend
- [x] Verificar que el terreno tiene todos los elementos (lago, montaña, árboles)

## Riesgos y Plan de Rollback

**Riesgos identificados:**
- El script elimina y recrea la dimensión si ya existe (idempotente)
- No afecta otras dimensiones existentes
- El cambio en `constants.js` afecta qué dimensión carga el frontend por defecto

**Plan de rollback:**
- Revertir commit y rebuild si es necesario
- Cambiar `DEMO_DIMENSION_NAME` en `constants.js` para volver al demo original
- El script no afecta datos existentes de otras dimensiones

## Notas Adicionales

- El terreno usa el mismo tamaño de celda que el demo anterior (0.25m) para compatibilidad
- El lago tiene forma orgánica con bordes irregulares para apariencia más natural
- La montaña tiene base circular con altura variable para forma más realista
- Los árboles se distribuyen automáticamente evitando el lago y la montaña
- El script es idempotente: se puede ejecutar múltiples veces (elimina y recrea)

## Anexo: Cambios Fuera del Plan

### Mejoras Adicionales al Terreno

- **Profundidad de tierra aumentada:**
  - **Cambio:** De 3 capas (z=-3 a z=-1) a 10 capas (z=-10 a z=-1)
  - **Razón:** Usuario solicitó más profundidad de tierra
  - **Impacto:** Más partículas de tierra, terreno más robusto

- **Profundidad del lago aumentada:**
  - **Cambio:** De 2 niveles (z=0 y z=1) a 10 niveles (z=0 a z=-9, bajo superficie)
  - **Razón:** Usuario solicitó más profundidad de agua
  - **Impacto:** Lago más profundo y realista

- **Lago con forma orgánica:**
  - **Cambio:** De forma cuadrada a forma circular/ovalada con variación aleatoria
  - **Razón:** Usuario solicitó lago más realista
  - **Impacto:** Apariencia más natural

- **Profundidad variable del lago:**
  - **Cambio:** Profundidad variable (más profundo en centro, menos en bordes)
  - **Razón:** Hacer el lago más realista
  - **Impacto:** Lago con forma de cuenco natural

- **Montaña con base circular:**
  - **Cambio:** De base cuadrada a base circular con variación en bordes
  - **Razón:** Usuario indicó que la base cuadrada se veía rara
  - **Impacto:** Montaña más natural y realista

- **Separación de lago y montaña:**
  - **Cambio:** Lago en centro-izquierda, montaña en esquina superior derecha
  - **Razón:** Usuario indicó que estaban uno encima del otro
  - **Impacto:** Mejor distribución visual y espacial

- **Tamaño de montaña aumentado:**
  - **Cambio:** De 4x4 metros a 6 metros de radio (base circular)
  - **Razón:** Hacer la montaña más visible y realista
  - **Impacto:** Montaña más prominente en el terreno

