# refactor(ecs): Centralización y Generalización de Sistemas de Animación e Input

## Resumen
Se ha refactorizado el sistema de animación e input para eliminar lógica hardcodeada y centralizar la configuración. Ahora `AnimationStateSystem` y `InputSystem` operan de manera data-driven, utilizando configuraciones en `src/config/`.

## Motivación
Los sistemas core (`AnimationStateSystem`, `InputSystem`) tenían dependencias fuertes de IDs específicos y teclas hardcodeadas, lo que dificultaba la escalabilidad y mantenibilidad. Se requería una arquitectura más flexible donde agregar nuevas animaciones o cambiar controles fuera puramente configuración.

## Criterios de Aceptación
- [x] `InputSystem` utiliza `input-map-config.js` para determinar acciones.
- [x] `AnimationStateSystem` no contiene referencias a IDs de estados específicos.
- [x] `AnimationMixerSystem` no contiene lógica específica de estados.
- [x] El juego mantiene toda la funcionalidad existente (movimiento, combate, combos) sin regresiones.

## Cambios Técnicos

### Frontend
- **Centralización de Configuración**:
    - Se movieron todas las configuraciones a `frontend/src/config/`.
    - Se creó `input-map-config.js` para mapeo de teclas a acciones.
    - Se actualizó `animation-config.js` agregando propiedades `type` y `combatType`.
- **Refactor InputSystem**:
    - Implementado método `checkAction(actionName)` que lee de `INPUT_MAP`.
    - Reemplazados chequeos directos (`isKeyPressed('KeyW')`) por acciones abstractas (`checkAction('moveForward')`).
- **Refactor AnimationStateSystem**:
    - Eliminados `if (state.id === 'special_attack')` y similares.
    - Implementada lógica genérica basada en `state.type` ('combat', 'movement', 'idle') y `state.combatType`.
- **Limpieza AnimationMixerSystem**:
    - Eliminados warnings hardcodeados para animaciones específicas.
    - Generalizada la lógica de interrupción.

## Testing
Se verificó manualmente la funcionalidad en el navegador:
- [x] Movimiento (WASD, Flechas) funciona correctamente.
- [x] Acciones de combate (Click, Ctrl+Click, Alt+Click) disparan las animaciones correctas.
- [x] Combos funcionan como se espera.
- [x] Transiciones de estado (idle -> walk -> run -> attack) son fluidas.

## Referencias
- Ticket: JDG-023
- Documentación: `frontend/src/config/README.md`

## Deployment

### Cambios Requeridos
- [ ] Rebuild Docker images (solo si se despliega en entorno nuevo, cambios son solo frontend)

### Verificación Post-Deployment
- [ ] Verificar controles de movimiento y combate en el navegador.

## Riesgos y Plan de Rollback
- **Riesgo**: Alguna combinación de teclas específica podría no estar mapeada correctamente.
- **Rollback**: Revertir a la versión anterior del frontend.

## Anexo: Cambios Fuera del Plan

### Centralización de Configuración
- **Cambio**: Se movieron todos los archivos de configuración de `ecs/animation/config` a `src/config`.
- **Razón**: Solicitud del usuario para mejorar la organización del proyecto y tener un único punto de verdad para configuraciones.
