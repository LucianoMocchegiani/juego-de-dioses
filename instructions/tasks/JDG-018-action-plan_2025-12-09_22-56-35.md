# JDG-018 - Limpieza de código obsoleto en módulos backend

## Descripción de la Tarea

Eliminar archivos deprecados, scripts temporales y carpetas vacías de los módulos `database`, `models` y `storage` del backend para mantener el código limpio y reducir la superficie de mantenimiento.

**Comportamiento actual:**
- Existen archivos deprecados (`tree_templates.py`)
- Existen scripts temporales de migración y debugging que ya no se usan
- Existen carpetas vacías preparadas para funcionalidades futuras no implementadas
- El README contiene referencias a archivos que no existen

**Comportamiento esperado:**
- Archivos deprecados eliminados
- Scripts temporales eliminados (después de verificar que no son necesarios)
- Carpetas vacías eliminadas
- Documentación actualizada y precisa
- Solo código activo y funcional en el proyecto

## Criterios de Aceptación

1. [ ] `tree_templates.py` ha sido eliminado
2. [ ] Scripts temporales (`cleanup_character_particles.py`, `check_character_position.py`) han sido eliminados
3. [ ] Carpetas vacías (`templates/plants/`, `templates/cuadrupedos/`) han sido eliminadas
4. [ ] El README de `database/` ha sido actualizado para reflejar la estructura real
5. [ ] Se eliminaron referencias a archivos que no existen
6. [ ] No hay referencias rotas en código activo
7. [ ] La estructura del proyecto está limpia y organizada

## Contexto del Proyecto

### Proyecto(s) Afectado(s)
- [x] Backend (FastAPI)
- [ ] Frontend (Three.js)
- [x] Base de Datos (scripts y módulos)
- [ ] Cache (Redis)
- [ ] Docker/Infraestructura
- [x] Documentación

### Tecnologías Involucradas
- Python 3.11
- Markdown (documentación)

## Pasos de Implementación

### Paso 1: Verificar Imports y Referencias de Archivos a Eliminar

**Descripción:**
Verificar que ningún código activo importe o use los archivos que se van a eliminar. Esto es crítico para evitar romper funcionalidad.

**Archivos a verificar:**
- `tree_templates.py`
- `cleanup_character_particles.py`
- `check_character_position.py`

**Detalles de implementación:**
```bash
# Buscar imports de tree_templates
grep -r "from.*tree_templates\|import.*tree_templates\|tree_templates\." backend/src/

# Buscar imports de cleanup_character_particles
grep -r "cleanup_character_particles" backend/src/

# Buscar imports de check_character_position
grep -r "check_character_position" backend/src/
```

**Notas:**
- Si se encuentran imports activos, documentarlos antes de eliminar
- Verificar también en documentación (READMEs, PRs históricos no cuentan)
- Los scripts pueden ejecutarse directamente (`python script.py`) sin ser importados, verificar si se llaman desde otros scripts

---

### Paso 2: Verificar Estado de Migración para Scripts de Limpieza

**Descripción:**
Verificar si `cleanup_character_particles.py` fue necesario para una migración y si esa migración ya se completó en todas las instancias del proyecto.

**Archivos a revisar:**
- `instructions/prs/JDG-011-pr-description_2025-12-06_20-46-35.md` - Menciona el script de limpieza

**Detalles de implementación:**
- Revisar documentación histórica para entender cuándo se usó este script
- Verificar si el script fue necesario solo para bases de datos existentes antes de JDG-011
- Si la migración ya se completó, el script puede eliminarse

**Notas:**
- Si el script puede ser necesario en el futuro para nuevas migraciones, considerarlo antes de eliminar
- El script puede mantenerse en el historial de Git si se necesita recuperar

---

### Paso 3: Eliminar Archivo Deprecado `tree_templates.py`

**Descripción:**
Eliminar `tree_templates.py` que está marcado como DEPRECADO y fue reemplazado por el sistema modular `templates/trees/`.

**Archivos a eliminar:**
- `backend/src/database/tree_templates.py`

**Detalles de implementación:**
```bash
# Eliminar archivo
rm backend/src/database/tree_templates.py
```

**Notas:**
- El README ya indica que este archivo está deprecado
- El sistema modular en `templates/trees/` es la implementación actual y funcional
- No hay imports activos de este archivo

---

### Paso 4: Eliminar Scripts Temporales

**Descripción:**
Eliminar scripts temporales de migración y debugging que ya no se usan en el código activo.

**Archivos a eliminar:**
- `backend/src/database/cleanup_character_particles.py`
- `backend/src/database/check_character_position.py`

**Detalles de implementación:**
```bash
# Eliminar scripts
rm backend/src/database/cleanup_character_particles.py
rm backend/src/database/check_character_position.py
```

**Notas:**
- `cleanup_character_particles.py` fue un script de migración para JDG-011
- `check_character_position.py` es un script de debugging que no se importa en código activo
- Los scripts pueden ejecutarse directamente pero no son parte del flujo de producción

---

### Paso 5: Eliminar Carpetas Vacías de Templates Futuros

**Descripción:**
Eliminar carpetas preparadas para funcionalidades futuras que no están implementadas. Estas carpetas solo contienen `__init__.py` vacío.

**Carpetas a eliminar:**
- `backend/src/database/templates/plants/`
- `backend/src/database/templates/cuadrupedos/`

**Detalles de implementación:**
```bash
# Eliminar carpetas completas
rm -rf backend/src/database/templates/plants/
rm -rf backend/src/database/templates/cuadrupedos/
```

**Notas:**
- Estas carpetas pueden recrearse fácilmente cuando se necesiten
- No hay código que dependa de estas carpetas
- Mantener la estructura limpia es más importante que preparar para el futuro

---

### Paso 6: Actualizar README de Database

**Descripción:**
Actualizar `backend/src/database/README.md` para reflejar la estructura real, eliminando referencias a archivos que no existen y a archivos eliminados.

**Archivos a modificar:**
- `backend/src/database/README.md`

**Detalles de implementación:**
- Eliminar referencias a `tree_templates.py` (ya está marcado como deprecado, eliminarlo completamente)
- Eliminar referencias a `seed_human_test.py` y `seed_character_test.py` (estos archivos no existen)
- Actualizar la sección de estructura para reflejar solo archivos existentes
- Eliminar secciones sobre scripts eliminados

**Notas:**
- Mantener referencias a `seed_demo.py` y `seed_character_with_model.py` que sí existen y se usan
- Asegurar que la estructura reflejada en el README coincida con la estructura real

---

### Paso 7: Verificar que No Hay Referencias Rotas

**Descripción:**
Después de eliminar archivos y actualizar documentación, verificar que no hay referencias rotas en código activo.

**Comandos:**
```bash
# Verificar que no quedan referencias a archivos eliminados en código activo
grep -r "tree_templates" backend/src/ --exclude-dir=__pycache__
grep -r "cleanup_character_particles" backend/src/ --exclude-dir=__pycache__
grep -r "check_character_position" backend/src/ --exclude-dir=__pycache__
```

**Notas:**
- Las referencias en documentación histórica (PRs, tickets anteriores) no necesitan actualizarse
- Solo importaciones o ejecuciones en código activo son problemáticas

---

### Paso 8: Verificar Funcionalidad del Backend

**Descripción:**
Verificar que el backend funciona correctamente después de las eliminaciones.

**Detalles de implementación:**
- Ejecutar el backend y verificar que inicia sin errores
- Verificar que `seed_demo.py` funciona (se ejecuta automáticamente en `main.py`)
- Verificar que `seed_character_with_model.py` funciona si se ejecuta manualmente

**Notas:**
- Los scripts eliminados no afectan el funcionamiento normal del backend
- Solo verificaciones básicas son necesarias

---

### Paso Final: Generar Descripción del Pull Request

**Descripción:**
Una vez completados todos los pasos anteriores, genera la descripción completa del Pull Request usando la regla `@pr-description.mdc`.

**Comando a ejecutar:**
```
@pr-description.mdc
```

**Resultado esperado:**
- Archivo generado: `JDG-018_pr-description_[FECHA-HORA].md` en `/instructions/prs/`
- El archivo contendrá una descripción completa del PR lista para copiar y pegar en Git

---

## Consideraciones Técnicas

### Compatibilidad
- Verificar imports antes de eliminar
- Asegurar que scripts activos (`seed_demo.py`, `seed_character_with_model.py`) siguen funcionando

### Historial Git
- Los archivos eliminados estarán disponibles en el historial de Git
- Pueden recuperarse si es necesario en el futuro

## Archivos Principales Involucrados

**Archivos a eliminar:**
1. `backend/src/database/tree_templates.py`
2. `backend/src/database/cleanup_character_particles.py`
3. `backend/src/database/check_character_position.py`

**Carpetas a eliminar:**
4. `backend/src/database/templates/plants/`
5. `backend/src/database/templates/cuadrupedos/`

**Archivos a modificar:**
6. `backend/src/database/README.md`

## Testing

### Verificación Manual
- [ ] Verificar que los archivos fueron eliminados
- [ ] Verificar que las carpetas fueron eliminadas
- [ ] Verificar que el README está actualizado
- [ ] Verificar que no hay referencias rotas en código activo
- [ ] Verificar que el backend inicia correctamente
- [ ] Verificar que `seed_demo.py` funciona

